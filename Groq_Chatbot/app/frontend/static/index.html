<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Groq Chat Assistant</title>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/highlight.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
  </head>
  <body
    class="bg-gray-900 text-white fixed inset-0 flex flex-col overflow-hidden"
  >
    <!-- Header -->
    <header
      class="bg-gray-800 shadow-md py-6 px-6 flex flex-col sm:flex-row sm:justify-between items-center space-y-3 sm:space-y-0 shrink-0"
    >
      <h1 class="text-2xl font-semibold text-white">💬 Groq Chat Assistant</h1>
      <div class="flex gap-4 items-center w-full sm:w-auto">
        <span>Select Model:</span>
        <select
          id="model-select"
          class="bg-gray-700 text-white px-4 py-2 rounded text-sm w-full max-w-xl"
        >
          <option value="openai/gpt-oss-120b">
            openai/gpt-oss-120b – 30 RPM, 1k RPD, 8K TPM, 200k TPD
          </option>
          <option value="openai/gpt-oss-20b">
            openai/gpt-oss-20b – 20 RPM, 1k RPD, 8K TPM, 200k TPD
          </option>
          <option value="compound-beta">
            compound-beta – 15 RPM, 200 RPD, 70K TPM, No Limit TPD
          </option>
          <option value="allam-2-7b">
            allam-2-7b – 30 RPM, 7K RPD, 6K TPM, 500K TPD
          </option>
          <option value="compound-beta-mini">
            compound-beta-mini – 15 RPM, 200 RPD, 70K TPM, No Limit TPD
          </option>
          <option value="deepseek-r1-distill-llama-70b">
            deepseek-r1-distill-llama-70b – 30 RPM, 1K RPD, 6K TPM, 100K TPD
          </option>
          <option value="gemma2-9b-it">
            gemma2-9b-it – 30 RPM, 14.4K RPD, 15K TPM, 500K TPD
          </option>
          <option value="llama-3.1-8b-instant">
            llama-3.1-8b-instant – 30 RPM, 14.4K RPD, 6K TPM, 500K TPD
          </option>
          <option value="llama-3.3-70b-versatile">
            llama-3.3-70b-versatile – 30 RPM, 1K RPD, 12K TPM, 100K TPD
          </option>
          <option value="llama3-70b-8192">
            llama3-70b-8192 – 30 RPM, 14.4K RPD, 6K TPM, 500K TPD
          </option>
          <option value="llama3-8b-8192">
            llama3-8b-8192 – 30 RPM, 14.4K RPD, 6K TPM, 500K TPD
          </option>
          <option value="meta-llama/llama-4-maverick-17b-128e-instruct">
            meta-llama/llama-4-maverick-17b-128e-instruct – 30 RPM, 1K RPD, 6K
            TPM, 500K TPD
          </option>
          <option value="meta-llama/llama-4-scout-17b-16e-instruct">
            meta-llama/llama-4-scout-17b-16e-instruct – 30 RPM, 1K RPD, 30K TPM,
            500K TPD
          </option>
          <option value="meta-llama/llama-guard-4-12b">
            meta-llama/llama-guard-4-12b – 30 RPM, 14.4K RPD, 15K TPM, 500K TPD
          </option>
          <option value="meta-llama/llama-prompt-guard-2-22m">
            meta-llama/llama-prompt-guard-2-22m – 30 RPM, 14.4K RPD, 15K TPM,
            500K TPD
          </option>
          <option value="meta-llama/llama-prompt-guard-2-86m">
            meta-llama/llama-prompt-guard-2-86m – 30 RPM, 14.4K RPD, 15K TPM,
            500K TPD
          </option>
          <option value="moonshotai/kimi-k2-instruct">
            moonshotai/kimi-k2-instruct – 60 RPM, 1K RPD, 10K TPM, 300K TPD
          </option>
          <option value="qwen/qwen3-32b">
            qwen/qwen3-32b – 60 RPM, 1K RPD, 6K TPM, 500K TPD
          </option>
        </select>
        <!-- 🔹 Trigger Button -->
      </div>
      <button
        id="login-btn"
        onclick="showAuthModal()"
        class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg text-sm"
      >
        Login
      </button>
      <div id="profile-menu" class="hidden relative">
        <button id="profile-btn" class="bg-gray-700 px-3 py-2 rounded text-sm">
          👤 <span id="profile-email"></span>
        </button>
        <div
          id="profile-dropdown"
          class="hidden absolute right-0 mt-2 bg-gray-800 border border-gray-700 rounded shadow-lg text-sm z-10"
        >
          <button
            onclick="logout()"
            class="block w-full px-4 py-2 text-left hover:bg-gray-700"
          >
            Logout
          </button>
        </div>
      </div>
    </header>

    <!-- Layout split: sidebar + chat area -->
    <div class="flex flex-1 overflow-hidden">
      <!-- Sidebar -->
      <aside
        class="w-64 bg-gray-800 border-r border-gray-700 flex flex-col shrink-0 overflow-y-auto"
      >
        <div
          class="p-4 border-b border-gray-700 flex justify-between items-center"
        >
          <!-- New Groq API Key button -->
          <button
            id="api-key-btn"
            class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm mt-2"
          >
            Add API Key
          </button>
        </div>
        <div
          class="p-4 border-b border-gray-700 flex justify-between items-center"
        >
          <h2 class="text-lg font-semibold">Chats</h2>
          <button
            onclick="createNewChat()"
            class="bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 text-sm rounded"
          >
            + New
          </button>
        </div>
        <div id="chat-sessions" class="flex-1 p-2 space-y-2">
          <!-- Chats will be populated here -->
        </div>
      </aside>

      <!-- Chat container -->
      <main class="flex-1 flex flex-col overflow-hidden">
        <div
          class="max-w-5xl mx-auto flex flex-col flex-1 overflow-hidden w-full"
        >
          <!-- Chat messages scroll area -->
          <div
            id="chat-box"
            class="flex-1 overflow-y-auto px-4 py-6 space-y-4 max-w-5xl mx-auto w-full"
          >
            <!-- messages inserted dynamically -->
          </div>

          <!-- Chat input -->
          <form
            id="chat-form"
            class="flex gap-4 p-4 bg-gray-800 border-t border-gray-700 w-full shrink-0"
          >
            <input
              type="text"
              id="user-input"
              class="flex-1 border border-gray-600 bg-gray-700 text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="Type your message..."
              autocomplete="off"
            />
            <button
              type="submit"
              class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg shadow"
            >
              Send
            </button>
          </form>
        </div>
      </main>
    </div>

    <!-- 🔐 Auth Modal -->
    <div
      id="auth-modal"
      class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 hidden"
    >
      <div
        class="bg-gradient-to-br from-gray-900 to-gray-800 text-white rounded-2xl shadow-2xl p-8 w-full max-w-lg border border-gray-700/60"
      >
        <!-- Modal Header -->
        <div class="flex justify-between items-center mb-6">
          <h2 id="auth-title" class="text-xl font-bold tracking-wide">Login</h2>
          <button
            onclick="hideAuthModal()"
            class="text-gray-400 hover:text-gray-200 text-2xl leading-none"
          >
            &times;
          </button>
        </div>

        <!-- Email Input -->
        <div class="mb-4">
          <label
            for="auth-email"
            class="block text-sm font-medium mb-2 text-gray-300"
            >Email</label
          >
          <input
            type="email"
            id="auth-email"
            placeholder="Enter your email"
            class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition appearance-none"
          />
        </div>

        <!-- Password Input -->
        <div class="mb-4">
          <label
            for="auth-password"
            class="block text-sm font-medium mb-2 text-gray-300"
            >Password</label
          >
          <input
            type="password"
            id="auth-password"
            placeholder="Enter your password"
            class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition appearance-none"
          />
        </div>

        <!-- Toggle Text -->
        <div class="mb-6 text-sm text-gray-400">
          <span
            id="auth-toggle"
            class="cursor-pointer hover:text-gray-200 transition"
            >No account? Register</span
          >
        </div>

        <!-- Buttons -->
        <div class="flex justify-end gap-3">
          <button
            onclick="hideAuthModal()"
            class="px-5 py-2 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-700 transition"
          >
            Cancel
          </button>
          <button
            onclick="submitAuth()"
            class="px-5 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-medium shadow-lg transition"
          >
            Submit
          </button>
        </div>
      </div>
    </div>

    <script src="/static/main.js" defer></script>
    <div
      id="api-key-modal"
      class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 hidden"
    >
      <div
        class="bg-gradient-to-br from-gray-900 to-gray-800 text-white rounded-2xl shadow-2xl p-8 w-full max-w-lg border border-gray-700/60"
      >
        <!-- Modal Header -->
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-xl font-bold tracking-wide">🔑 API Key Settings</h2>
          <button
            id="cancel-api-key"
            class="text-gray-400 hover:text-gray-200 text-2xl leading-none"
          >
            &times;
          </button>
        </div>

        <!-- Provider Selector -->
        <div class="mb-5">
          <label
            for="select-provider"
            class="block text-sm font-medium mb-2 text-gray-300"
          >
            Platform
          </label>
          <select
            id="select-provider"
            class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
          >
            <option value="Groq">Groq</option>
            <option value="OpenRouter">OpenRouter</option>
          </select>
        </div>

        <!-- API Key Input -->
        <div class="mb-6">
          <label
            for="api-key-input"
            class="block text-sm font-medium mb-2 text-gray-300"
          >
            API Key
          </label>
          <input
            type="text"
            id="api-key-input"
            placeholder="Paste your API key here..."
            class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
          />
        </div>

        <!-- Buttons -->
        <div class="flex justify-end gap-3">
          <button
            id="cancel-api-key"
            class="px-5 py-2 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-700 transition"
          >
            Cancel
          </button>
          <button
            id="save-api-key"
            class="px-5 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-medium shadow-lg transition"
          >
            Save
          </button>
        </div>
      </div>
    </div>
  </body>
  <style>
    body {
      transform: scale(0.85);
      transform-origin: top left;
      /* Prevent scrollbars due to scaling */
      width: 117.65%; /* 1 / 0.8 = 1.25 */
      height: 117.65%;
    }
    input:-webkit-autofill {
      -webkit-box-shadow: 0 0 0 1000px #1f2937 inset !important;
      -webkit-text-fill-color: #fff !important;
      transition: background-color 5000s ease-in-out 0s;
    }

    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-thumb {
      background: #4b5563;
      border-radius: 8px;
    }
    .loader {
      border: 4px solid #1f2937;
      border-top: 4px solid #60a5fa;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }
    .typing-indicator {
      display: inline-flex;
      gap: 4px;
      align-items: center;
      margin-top: 4px;
    }

    .typing-indicator span {
      width: 6px;
      height: 6px;
      background: #999;
      border-radius: 50%;
      animation: blink 1.4s infinite ease-in-out;
    }

    .typing-indicator span:nth-child(2) {
      animation-delay: 0.2s;
    }
    .typing-indicator span:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes blink {
      0%,
      80%,
      100% {
        opacity: 0.3;
        transform: scale(0.8);
      }
      40% {
        opacity: 1;
        transform: scale(1.2);
      }
    }
    .chat-box pre {
      background-color: #1e293b; /* slate-800 */
      color: #e2e8f0; /* slate-200 */
      padding: 0.75rem;
      border-radius: 0.5rem;
      overflow-x: auto;
    }
    .chat-box code {
      background-color: #334155;
      padding: 0.2rem 0.4rem;
      border-radius: 0.25rem;
    }
    .chat-box h1,
    .chat-box h2,
    .chat-box h3 {
      margin-top: 1rem;
      font-weight: 600;
    }
    .chat-box ul {
      list-style-type: disc;
      margin-left: 1.5rem;
    }
  </style>
</html>
